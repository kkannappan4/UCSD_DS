# Read CSV
r_csv2 <- function(X.file_path) {
read.csv(file = X.file_path,header = TRUE,sep = ",",stringsAsFactors = FALSE)
}
### NFL DATA ###
nfl_runs <- r_csv2("./rushers_lines.csv") # Read in Rushes CSV from Python Output
nfl_runs <- nfl_runs %>% filter(Position%in%c('RB','HB')) %>%
mutate(speed_mph = round((S*60^2)/1760,1),acc_mph = round((A*60^2)/1760,1))# only care about RB/HB, translate speed and acc to MPH
teams <- nfl_runs %>% select(PossessionTeam) %>% unique() %>% arrange(PossessionTeam) %>% pull() # Get team list, alpha sort
nfl_teamcolors <- teamcolors %>% filter(league == "nfl") # Get team colors package
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(gridExtra)
require(grImport2)
require(grConvert)
require(gridSVG)
require(teamcolors)
require(stringr)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shinytest::recordTest("~/Documents/DSE/DSE241/final_project/shiny/NFLRunsDSE")
runApp()
View(nfl_runs)
View(nfl_runs)
### NFL DATA ###
nfl_runs <- r_csv2("./rushers_lines.csv") # Read in Rushes CSV from Python Output
nfl_runs <- nfl_runs %>% filter(Position%in%c('RB','HB')) %>%
mutate(speed_mph = round((S*60^2)/1760,1),acc_mph = round((A*60^2)/1760,1))# only care about RB/HB, translate speed and acc to MPH
teams <- nfl_runs %>% select(PossessionTeam) %>% unique() %>% arrange(PossessionTeam) %>% pull() # Get team list, alpha sort
nfl_teamcolors <- teamcolors %>% filter(league == "nfl") # Get team colors package
nfl_teamcolors <- nfl_teamcolors[c(1:16,18,17,19:27,29,28,30:nrow(nfl_teamcolors)),] # Re-Order to match team list
# Combine teams and team colors
teams <- cbind(teams,nfl_teamcolors)
View(nfl_runs)
View(nfl_runs)
View(nfl_runs)
runApp()
runApp()
runApp()
runApp()
install.packages("plotly")
install.packages("semantic.dashboard")
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
View(teams)
### NFL DATA ###
nfl_runs <- r_csv2("./rushers_lines.csv") # Read in Rushes CSV from Python Output
nfl_runs <- nfl_runs %>% filter(Position%in%c('RB','HB')) %>%
mutate(speed_mph = round((S*60^2)/1760,1),acc_mph = round((A*60^2)/1760,1))# only care about RB/HB, translate speed and acc to MPH
teams <- nfl_runs %>% select(PossessionTeam) %>% unique() %>% arrange(PossessionTeam) %>% pull() # Get team list, alpha sort
nfl_teamcolors <- teamcolors %>% filter(league == "nfl") # Get team colors package
nfl_teamcolors <- nfl_teamcolors[c(1:16,18,17,19:27,29,28,30:nrow(nfl_teamcolors)),] # Re-Order to match team list
# Combine teams and team colors
teams <- cbind(teams,nfl_teamcolors)
View(teams)
View(teams)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
offensive_formations <- nfl_runs %>% select(OffenseFormation) %>% unique()
View(offensive_formations)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
View(nfl_runs)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
plot_data <- nfl_runs
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp()
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
View(teams)
View(nfl_runs)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
library(data.table)
detach("package:data.table", unload = TRUE)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
df <- nfl_runs %>% select(X, Y, speed_mph) %>%
mutate(xbin=ntile(X, 100), ybin=ntile(Y, 53)) %>%
group_by(xbin, ybin) %>%
summarise(
mean_speed = mean(speed_mph)
)
mean_speed <- pivot_wider(df, names_from=xbin, values_from=mean_speed)
ggplotly(df, aes(x=xbin, y=ybin, fill=mean_speed)) + geom_tile()
ggplot(df, aes(x=xbin, y=ybin, fill=mean_speed)) + geom_tile()
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
View(nfl_runs)
b <- nfl_runs %>% group_by_(PossessionTeam) %>% summarise(mean(Yards))
b <- nfl_runs %>% group_by(PossessionTeam) %>% summarise(mean(Yards))
b <- nfl_runs %>% group_by(PossessionTeam,"Down") %>% summarise(mean(Yards))
View(b)
b <- nfl_runs %>% group_by_(PossessionTeam,"Down") %>% summarise(mean(Yards))
?group_by
b <- nfl_runs %>% group_by_at(PossessionTeam,"Down") %>% summarise(mean(Yards))
b <- nfl_runs %>% group_by_at(vars(PossessionTeam,"Down")) %>% summarise(mean(Yards))
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
View(nfl_runs)
View(teams)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
var = "Yards"
b <- nfl_runs %>% group_by_at(vars(PossessionTeam,"Down")) %>% summarise(mean(var))
View(b)
b <- nfl_runs %>% group_by_at(vars(PossessionTeam,"Down")) %>% summarise(mean(!!var))
b <- nfl_runs %>% group_by_at(vars(PossessionTeam,"Down")) %>% summarise(mean(sym(!!var)))
b <- nfl_runs %>% group_by_at(vars(PossessionTeam,"Down")) %>% summarise(mean(!!sym(var)))
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
teams$teams <- as.character(teams$teams)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
c <- [1,6]
c <- c(1,6)
d <- c(2019)
e <- "San Francisco 49ers"
plot_data <- nfl_runs %>%
filter(PossessionTeam==e & dplyr::between(Season,d[1],d[2]) &
dplyr::between(DefendersInTheBox,c[1],c[2]))
d[2]
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
f <- nfl_runs %>%
+     filter(PossessionTeam==e & dplyr::between(Season,d[1],d[1]) &
+                dplyr::between(DefendersInTheBox,c[1],c[2]))
View(teams)
e = "SF"
f <- nfl_runs %>%
+     filter(PossessionTeam==e & dplyr::between(Season,d[1],d[1]) &
+                dplyr::between(DefendersInTheBox,c[1],c[2]))
f <- nfl_runs %>%
+     filter(!!sym(PossessionTeam)==e & dplyr::between(Season,d[1],d[1]) &
+                dplyr::between(DefendersInTheBox,c[1],c[2]))
nfl_runs %>% filter(PossessionTeam=='SF')
nfl_runs %>% filter(PossessionTeam==e)
f <- nfl_runs %>%
+     filter(PossessionTeam==e & dplyr::between(Season,d[1],d[1]) &
+                dplyr::between(DefendersInTheBox,c[1],c[2]))
f <- nfl_runs %>% filter(PossessionTeam==e & dplyr::between(Season,d[1],d[1]) &
+                dplyr::between(DefendersInTheBox,c[1],c[2]))
f <- nfl_runs %>% filter(PossessionTeam==e & dplyr::between(Season,d[1],d[1]) & dplyr::between(DefendersInTheBox,c[1],c[2]))
View(f)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
b <- plot_data <- nfl_runs %>% group_by(PossessionTeam) %>% summarise(metric = sum(!!sym(var))) %>%
left_join(.,teams,by=c("PossessionTeam"="teams"))
View(b)
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
g <- plot_data <- nfl_runs %>% group_by_at(PossessionTeam,"Season") %>% summarise(metric = sum(!!sym(var))) %>%
left_join(.,teams,by=c("PossessionTeam"="teams"))
g <- nfl_runs %>% group_by_at(PossessionTeam,"Season") %>% summarise(metric = sum(!!sym(var))) %>%
left_join(.,teams,by=c("PossessionTeam"="teams"))
g <- nfl_runs %>% group_by_at(vars(PossessionTeam,"Season")) %>% summarise(metric = sum(!!sym(var))) %>%
left_join(.,teams,by=c("PossessionTeam"="teams"))
View(g)
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill="primary",color=colnames(plot_agg)[2])) +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab(input$metric)
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill="primary",color=colnames(g)[2])) +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab(input$metric)
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill="primary",color=colnames(g)[2])) +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill="primary") +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill="primary")) +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill=colnames(g)[2]) +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill=colnames(g)[2])) +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill=colnames(g)[2])) +
geom_bar(stat="identity",width = 0.5,position = "dodge") + scale_fill_identity() + ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill=colnames(g)[2])) +
geom_bar(stat="identity",position = position_dodge(width = 0.5)) + scale_fill_identity() + ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill=colnames(g)[2])) +
geom_bar(stat="identity",position = position_dodge(width = 0.5))+ ylab('Blah')
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill=colnames(g)[2]),color="primary") +
geom_bar(stat="identity",position = position_dodge(width = 0.5))+ ylab('Blah') + scale_color_identity()
ggplot(g,aes_string(x="PossessionTeam",y="metric",fill=colnames(g)[2],color="primary")) +
geom_bar(stat="identity",position = position_dodge(width = 0.5))+ ylab('Blah') + scale_color_identity()
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
runApp('~/Documents/DSE/DSE241/final_project/shiny/nflruns_dse')
